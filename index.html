<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì—¬í–‰ ë¦¬ë” ê´€ë¦¬ì í˜ì´ì§€ (JSON ìƒì„±ê¸°)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      color: #111827;
      background-image: url("bg_wallpaper.jpg");
      background-size: cover;
      background-position: center top;
      background-attachment: fixed;
    }

    .page-wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 12px 32px;
    }

    .glass-panel {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 24px;
      border: 1px solid rgba(209,213,219,1);
      box-shadow: 0 20px 40px rgba(0,0,0,0.35);
      padding: 20px 18px 22px;
    }

    .page-header {
      text-align: center;
      margin-bottom: 16px;
    }
    .page-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .page-subtitle {
      font-size: 12px;
      color: #4b5563;
      line-height: 1.6;
    }

    .admin-layout {
      display: grid;
      grid-template-columns: 1.1fr 1.1fr;
      gap: 18px;
      margin-top: 8px;
    }

    .admin-card {
      background: #ffffff;
      border-radius: 16px;
      padding: 14px 16px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.08);
      font-size: 13px;
      border: 1px solid #e5e7eb;
    }

    .admin-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .form-row-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .form-group { margin-bottom: 8px; }
    label {
      display: block;
      font-size: 12px;
      margin-bottom: 3px;
      color: #374151;
    }
    input[type="text"],
    textarea {
      width: 100%;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      font-size: 12px;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    input[type="file"] { font-size: 11px; }
    small { font-size: 11px; color: #6b7280; }

    .btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: none;
      font-size: 12px;
      cursor: pointer;
    }
    .btn-primary {
      background-color: #2563eb;
      color: #fff;
      margin-right: 4px;
    }
    .btn-secondary {
      background-color: #6b7280;
      color: #fff;
      margin-right: 4px;
    }
    .btn-danger {
      background-color: #ef4444;
      color: #fff;
    }
    .btn-outline {
      background-color: #ffffff;
      color: #4b5563;
      border: 1px solid #d1d5db;
    }

    .leader-list {
      max-height: none;
      overflow-y: visible;
    }
    .leader-item {
      border-bottom: 1px solid #e5e7eb;
      padding: 7px 0;
      font-size: 12px;
    }
    .leader-item:last-child { border-bottom: none; }

    .leader-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2px;
    }
    .leader-item-name { font-weight: 600; }

    .thumb {
      width: 32px;
      height: 40px;
      object-fit: cover;
      border-radius: 5px;
      margin-right: 6px;
      border: 1px solid #e5e7eb;
    }

    .link-small {
      font-size: 10px;
      color: #2563eb;
      text-decoration: underline;
      display: inline-block;
      max-width: 260px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .drop-zone {
      margin-top: 6px;
      padding: 10px;
      border-radius: 10px;
      border: 2px dashed #cbd5f5;
      background: #f9fafb;
      font-size: 11px;
      color: #4b5563;
      text-align: center;
    }
    .drop-zone.dragover {
      border-color: #2563eb;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .json-area {
      width: 100%;
      min-height: 180px;
      font-family: "SF Mono", Menlo, Consolas, monospace;
      font-size: 11px;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background-color: #f9fafb;
      resize: vertical;
      white-space: pre;
    }

    .help-box {
      margin-top: 8px;
      padding: 8px;
      border-radius: 8px;
      background-color: #fefce8;
      border: 1px solid #facc15;
      font-size: 11px;
      color: #4b5563;
      line-height: 1.5;
    }

    .banner-box {
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 10px;
      background-color: #f3f4ff;
      border: 1px solid #c7d2fe;
      font-size: 11px;
      color: #374151;
    }

    @media (max-width: 900px) {
      .admin-layout { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<div class="page-wrap">
  <div class="glass-panel">
    <header class="page-header">
      <div class="page-title">ì—¬í–‰ ë¦¬ë” ê´€ë¦¬ì í˜ì´ì§€ (JSON ìƒì„±ê¸°)</div>
      <p class="page-subtitle">
        ì´ í˜ì´ì§€ì—ì„œ ë¦¬ë” ì •ë³´ë¥¼ ì¶”ê°€ / ìˆ˜ì • / ì‚­ì œí•˜ê³ , ì•„ë˜ JSONì„ ë³µì‚¬í•˜ì—¬<br>
        <b>so.t-leader-choice</b> ë ˆí¬ì˜ <code>leaders.json</code> íŒŒì¼ì— ë¶™ì—¬ ë„£ìœ¼ë©´<br>
        PC / ëª¨ë°”ì¼ / ëª¨ë“  ì‚¬ìš©ìì˜ ê³µê°œ í˜ì´ì§€ê°€ ë™ì¼í•˜ê²Œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
      </p>
    </header>

    <div class="admin-layout">
      <!-- ë°°ë„ˆ + ì…ë ¥ í¼ -->
      <div class="admin-card">
        <!-- ë°°ë„ˆ ì„¤ì • -->
        <div class="banner-box">
          <div class="admin-title" style="margin-bottom:6px;">í•˜ë‹¨ ê´‘ê³  / ì±„ë„ ë§í¬ ë°” ì„¤ì •</div>
          <div class="form-group">
            <label for="bannerLabel">ë°°ë„ˆ ë¬¸êµ¬</label>
            <input type="text" id="bannerLabel" placeholder="ì˜ˆ) ğŸŒ so.t ì±„ë„ì—ì„œ ë‹¤ìŒ ì—¬í–‰ ì¤€ë¹„í•˜ê¸°">
          </div>
          <div class="form-group">
            <label for="bannerYoutube">YouTube ì±„ë„ URL</label>
            <input type="text" id="bannerYoutube" placeholder="https://www.youtube.com/@yourchannel">
          </div>
          <div class="form-group">
            <label for="bannerTiktok">TikTok ì±„ë„ URL</label>
            <input type="text" id="bannerTiktok" placeholder="https://www.tiktok.com/@yourid">
          </div>
          <div class="form-group">
            <label for="bannerInstagram">Instagram ì±„ë„ URL</label>
            <input type="text" id="bannerInstagram" placeholder="https://www.instagram.com/yourid">
          </div>
          <div class="form-group" style="margin-bottom:0;">
            <label for="bannerFacebook">Facebook í˜ì´ì§€ URL</label>
            <input type="text" id="bannerFacebook" placeholder="https://www.facebook.com/yourpage">
          </div>
        </div>

        <!-- ë¦¬ë” ì…ë ¥ í¼ -->
        <div class="form-row-top">
          <div class="admin-title">ë¦¬ë” ì •ë³´ ì…ë ¥ / ìˆ˜ì •</div>
          <button class="btn btn-outline" id="newLeaderBtn">+ ìƒˆ ë¦¬ë” ì¶”ê°€</button>
        </div>

        <input type="hidden" id="editingIndex" value="-1">

        <div class="form-group">
          <label for="leaderName">ì´ë¦„</label>
          <input type="text" id="leaderName" placeholder="ì˜ˆ) ê¹€ì² ìˆ˜">
        </div>

        <div class="form-group">
          <label for="leaderRole">ì—­í•  / ì§í•¨</label>
          <input type="text" id="leaderRole" placeholder="ì˜ˆ) ë² íŠ¸ë‚¨ ì¥ê¸° ì²´ë¥˜ ë¦¬ë” Â· 10ë…„ ì°¨ ê°€ì´ë“œ">
        </div>

        <div class="form-group">
          <label for="leaderLink">ìƒë‹´ / ì‹ ì²­ ë§í¬ (êµ¬ê¸€í¼ URL)</label>
          <input type="text" id="leaderLink" placeholder="ì˜ˆ) https://docs.google.com/forms/...">
        </div>

        <div class="form-group">
          <label for="leaderSheetUrl">ì‘ë‹µ ì‹œíŠ¸ ë§í¬ (êµ¬ê¸€ ì‹œíŠ¸ URL)</label>
          <input type="text" id="leaderSheetUrl" placeholder="ì˜ˆ) https://docs.google.com/spreadsheets/...">
        </div>

        <div class="form-group">
          <label for="leaderTags">í‚¤ì›Œë“œ íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
          <input type="text" id="leaderTags" placeholder="ì˜ˆ) ì¥ê¸° ì²´ë¥˜, ë¡œì»¬ ìƒí™œ, ë£¨í‹´ ì—¬í–‰">
        </div>

        <div class="form-group">
          <label for="leaderIntro">í•œ ì¤„ ì†Œê°œ / ì§§ì€ ì„¤ëª…</label>
          <textarea id="leaderIntro" placeholder="ì˜ˆ) ì—¬í–‰ì´ ì•„ë‹ˆë¼ â€˜ì‚´ì•„ë³´ëŠ” ì‹œê°„â€™ì„ ì„¤ê³„í•©ë‹ˆë‹¤. ìµœì†Œ 1ê°œì›” ì´ìƒ ë¨¸ë¬´ëŠ” ë£¨íŠ¸ë¥¼ í•¨ê»˜ ì§­ë‹ˆë‹¤."></textarea>
        </div>

        <div class="form-group">
          <label>í”„ë¡œí•„ ì´ë¯¸ì§€ (ì´ë¯¸ì§€ íŒŒì¼)</label>
          <input type="file" id="leaderMediaFile" accept="image/*">
          <small>íŒŒì¼ ì„ íƒ ë˜ëŠ” ì•„ë˜ ì˜ì—­ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­ (ì´ë¯¸ì§€ ì „ìš©). í° ì´ë¯¸ì§€ëŠ” ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì¶•ì†Œí•©ë‹ˆë‹¤.</small>
          <div id="dropZone" class="drop-zone">
            ì—¬ê¸°ë¡œ ì´ë¯¸ì§€ë¥¼ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”.
          </div>
          <div id="imagePreviewWrap" style="margin-top:8px; display:none;">
            <img id="imagePreview" src="" alt="ë¯¸ë¦¬ë³´ê¸°"
                 style="width:120px;height:150px;object-fit:cover;border-radius:8px;border:1px solid #e5e7eb;">
          </div>
        </div>

        <button class="btn btn-primary" id="saveLeaderBtn">ì €ì¥í•˜ê¸°</button>
        <button class="btn btn-secondary" id="clearFormBtn">í¼ ì´ˆê¸°í™”</button>
      </div>

      <!-- ë¦¬ìŠ¤íŠ¸ + JSON -->
      <div class="admin-card">
        <div class="admin-title">ë¦¬ë” ë¦¬ìŠ¤íŠ¸</div>
        <div class="leader-list" id="leaderList"></div>
        <hr style="margin:10px 0;">
        <div class="admin-title" style="margin-top:4px;">leaders.json ìƒì„± / ë³µì‚¬</div>
        <button class="btn btn-primary" id="generateJsonBtn">JSON ìƒì„±í•˜ê¸°</button>
        <button class="btn btn-secondary" id="copyJsonBtn">JSON ë³µì‚¬í•˜ê¸°</button>
        <button class="btn btn-outline" id="openJsonBtn">GitHub leaders.json ì—´ê¸°</button>
        <textarea id="jsonOutput" class="json-area" placeholder="ì—¬ê¸°ì— leaders.json ë‚´ìš©ì´ ìƒì„±ë©ë‹ˆë‹¤." readonly></textarea>
        <div class="help-box">
          <b>[GitHubì— ë¶™ì—¬ ë„£ëŠ” ë°©ë²•]</b><br>
          1) ìœ„ì—ì„œ ë°°ë„ˆ + ë¦¬ë”ë“¤ì„ ëª¨ë‘ ì›í•˜ëŠ” ëŒ€ë¡œ ì¶”ê°€/ìˆ˜ì •/ì‚­ì œí•œ ë’¤, <b>JSON ìƒì„±í•˜ê¸°</b> ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.<br>
          2) <b>JSON ë³µì‚¬í•˜ê¸°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ leaders.json ë‚´ìš©ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í•©ë‹ˆë‹¤.<br>
          3) <b>GitHub leaders.json ì—´ê¸°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ GitHubì˜ leaders.json íŒŒì¼ í¸ì§‘ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>
          4) GitHubì—ì„œ ë‚´ìš© ì „ì²´ ì„ íƒ(Ctrl+A) í›„ ì‚­ì œ â†’ ë³µì‚¬í•œ JSONì„ ë¶™ì—¬ ë„£ê¸°(Ctrl+V).<br>
          5) ì•„ë˜ìª½ <b>Commit changes</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì €ì¥.<br>
          6) ê³µê°œ í˜ì´ì§€(<code>https://wordycow.github.io/so.t-leader-choice/</code>)ì—ì„œ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ëª¨ë“  ì‚¬ìš©ìê°€ ë™ì¼í•œ ë¦¬ë” ì •ë³´ë¥¼ ë³´ê²Œ ë©ë‹ˆë‹¤.
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // ë¸Œë¼ìš°ì € ì•ˆ ì„ì‹œ ì €ì¥ìš© (ë°°ë„ˆ + ë¦¬ë” í†µí•©)
  const DRAFT_KEY = "so_t_leaders_draft_v2";

  function getDefaultData() {
    return {
      banner: {
        label: "ğŸŒ so.t ì±„ë„ì—ì„œ ë‹¤ìŒ ì—¬í–‰ ì¤€ë¹„í•˜ê¸°",
        youtube: "",
        tiktok: "",
        instagram: "",
        facebook: ""
      },
      leaders: [
        {
          name: "ê¹€í˜„ìˆ˜",
          role: "ë² íŠ¸ë‚¨ ì¥ê¸° ì²´ë¥˜ ë¦¬ë” Â· 10ë…„ ì°¨ ê°€ì´ë“œ",
          mediaUrl: "https://via.placeholder.com/300x380.png?text=Leader+1",
          link: "#",
          sheetUrl: "",
          tags: ["ì¥ê¸° ì²´ë¥˜", "ë¡œì»¬ ìƒí™œ", "ë£¨í‹´ ì—¬í–‰"],
          introShort: "ì—¬í–‰ì´ ì•„ë‹ˆë¼ â€˜ì‚´ì•„ë³´ëŠ” ì‹œê°„â€™ì„ ì„¤ê³„í•©ë‹ˆë‹¤. ìµœì†Œ 1ê°œì›” ì´ìƒ ë¨¸ë¬´ëŠ” ë£¨íŠ¸ë¥¼ í•¨ê»˜ ì§­ë‹ˆë‹¤."
        }
      ]
    };
  }

  function loadDraft() {
    try {
      const raw = localStorage.getItem(DRAFT_KEY);
      if (!raw) return getDefaultData();
      const parsed = JSON.parse(raw);
      if (!parsed || typeof parsed !== "object") return getDefaultData();
      if (!Array.isArray(parsed.leaders)) parsed.leaders = [];
      if (!parsed.banner) parsed.banner = getDefaultData().banner;
      return parsed;
    } catch {
      return getDefaultData();
    }
  }

  function saveDraft() {
    localStorage.setItem(DRAFT_KEY, JSON.stringify(data));
  }

  let data   = loadDraft();
  let leaders = data.leaders;

  const leaderListEl    = document.getElementById("leaderList");
  const editingIndexEl  = document.getElementById("editingIndex");

  const bannerLabelInput    = document.getElementById("bannerLabel");
  const bannerYoutubeInput  = document.getElementById("bannerYoutube");
  const bannerTiktokInput   = document.getElementById("bannerTiktok");
  const bannerInstagramInput= document.getElementById("bannerInstagram");
  const bannerFacebookInput = document.getElementById("bannerFacebook");

  const nameInput       = document.getElementById("leaderName");
  const roleInput       = document.getElementById("leaderRole");
  const linkInput       = document.getElementById("leaderLink");
  const sheetInput      = document.getElementById("leaderSheetUrl");
  const tagsInput       = document.getElementById("leaderTags");
  const introInput      = document.getElementById("leaderIntro");
  const mediaInput      = document.getElementById("leaderMediaFile");
  const dropZone        = document.getElementById("dropZone");
  const imagePreviewWrap= document.getElementById("imagePreviewWrap");
  const imagePreview    = document.getElementById("imagePreview");
  const newLeaderBtn    = document.getElementById("newLeaderBtn");

  const jsonOutput      = document.getElementById("jsonOutput");
  const generateJsonBtn = document.getElementById("generateJsonBtn");
  const copyJsonBtn     = document.getElementById("copyJsonBtn");
  const openJsonBtn     = document.getElementById("openJsonBtn");

  let tempMediaDataUrl  = "";

  // ---- ì´ˆê¸° ë°°ë„ˆ ê°’ ì±„ìš°ê¸° ----
  function fillBannerForm() {
    const b = data.banner || {};
    bannerLabelInput.value     = b.label     || "";
    bannerYoutubeInput.value   = b.youtube   || "";
    bannerTiktokInput.value    = b.tiktok    || "";
    bannerInstagramInput.value = b.instagram || "";
    bannerFacebookInput.value  = b.facebook  || "";
  }

  function updateBannerFromForm() {
    data.banner = {
      label:     bannerLabelInput.value.trim(),
      youtube:   bannerYoutubeInput.value.trim(),
      tiktok:    bannerTiktokInput.value.trim(),
      instagram: bannerInstagramInput.value.trim(),
      facebook:  bannerFacebookInput.value.trim()
    };
  }

  // ---- ë¦¬ë” ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ----
  function renderLeaderList() {
    leaderListEl.innerHTML = "";
    if (leaders.length === 0) {
      leaderListEl.innerHTML = "<p style='font-size:12px;color:#6b7280;'>ë“±ë¡ëœ ë¦¬ë”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
      return;
    }
    leaders.forEach((leader, index) => {
      const item = document.createElement("div");
      item.className = "leader-item";

      const sheetLinkHtml = leader.sheetUrl
        ? `<a href="${leader.sheetUrl}" target="_blank" rel="noopener noreferrer" class="link-small">ì‘ë‹µ ì‹œíŠ¸ ì—´ê¸°</a>`
        : "<span style='font-size:10px;color:#9ca3af;'>ì‘ë‹µ ì‹œíŠ¸ ë§í¬ ì—†ìŒ</span>";

      item.innerHTML = `
        <div class="leader-item-header">
          <div style="display:flex;align-items:center;">
            ${leader.mediaUrl ? `<img src="${leader.mediaUrl}" class="thumb" alt="">` : ""}
            <div>
              <div class="leader-item-name">${leader.name || "(ì´ë¦„ ì—†ìŒ)"}</div>
              <div style="font-size:11px;color:#6b7280;">${leader.role || ""}</div>
              ${
                leader.link
                  ? `<a href="${leader.link}" target="_blank" rel="noopener noreferrer" class="link-small">${leader.link}</a>`
                  : "<span class='link-small' style='color:#9ca3af;text-decoration:none;'>ìƒë‹´ ë§í¬ ì—†ìŒ</span>"
              }
              <br>
              ${sheetLinkHtml}
            </div>
          </div>
          <div>
            <button class="btn btn-outline" onclick="openSheet(${index})">ê²°ê³¼ ë³´ê¸°</button>
            <button class="btn btn-secondary" onclick="editLeader(${index})">ìˆ˜ì •</button>
            <button class="btn btn-danger" onclick="deleteLeader(${index})">ì‚­ì œ</button>
          </div>
        </div>
        <div style="font-size:11px;color:#4b5563;">
          íƒœê·¸: ${(leader.tags || []).join(", ") || "-"}
        </div>
      `;
      leaderListEl.appendChild(item);
    });
  }

  function clearPreview() {
    imagePreviewWrap.style.display = "none";
    imagePreview.src = "";
    tempMediaDataUrl = "";
  }

  function showPreview(dataUrl) {
    tempMediaDataUrl = dataUrl;
    imagePreview.src = dataUrl;
    imagePreviewWrap.style.display = "block";
  }

  function handleFile(file) {
    if (!file) return;
    if (!file.type.startsWith("image/")) {
      alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      return;
    }
    const reader = new FileReader();
    reader.onload = (e) => {
      const dataUrl = e.target.result;
      showPreview(dataUrl);
    };
    reader.readAsDataURL(file);
  }

  mediaInput.addEventListener("change", function () {
    const file = this.files[0];
    handleFile(file);
  });

  ["dragenter","dragover"].forEach((evt) => {
    dropZone.addEventListener(evt, (e) => {
      e.preventDefault(); e.stopPropagation();
      dropZone.classList.add("dragover");
    });
  });
  ["dragleave","drop"].forEach((evt) => {
    dropZone.addEventListener(evt, (e) => {
      e.preventDefault(); e.stopPropagation();
      dropZone.classList.remove("dragover");
    });
  });
  dropZone.addEventListener("drop", (e) => {
    const file = e.dataTransfer.files[0];
    handleFile(file);
  });

  function clearForm() {
    editingIndexEl.value = -1;
    nameInput.value  = "";
    roleInput.value  = "";
    linkInput.value  = "";
    sheetInput.value = "";
    tagsInput.value  = "";
    introInput.value = "";
    mediaInput.value = "";
    clearPreview();
  }

  document.getElementById("clearFormBtn").addEventListener("click", clearForm);
  newLeaderBtn.addEventListener("click", clearForm);

  document.getElementById("saveLeaderBtn").addEventListener("click", () => {
    const name = nameInput.value.trim();
    if (!name) {
      alert("ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
      return;
    }
    const role      = roleInput.value.trim();
    const link      = linkInput.value.trim();
    const sheetUrl  = sheetInput.value.trim();
    const tags      = tagsInput.value.split(",").map((t) => t.trim()).filter(Boolean);
    const introShort= introInput.value.trim();
    const index     = parseInt(editingIndexEl.value, 10);

    const baseData = { name, role, link, sheetUrl, tags, introShort };

    if (index >= 0) {
      const prev = leaders[index];
      leaders[index] = {
        ...prev,
        ...baseData,
        mediaUrl: tempMediaDataUrl || prev.mediaUrl || ""
      };
    } else {
      leaders.push({
        ...baseData,
        mediaUrl: tempMediaDataUrl || ""
      });
    }

    updateBannerFromForm();
    saveDraft();
    renderLeaderList();
    alert("ì„ì‹œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. JSON ìƒì„±í•˜ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ leaders.json ë‚´ìš©ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.");
    clearForm();
  });

  window.editLeader = function (index) {
    const leader = leaders[index];
    editingIndexEl.value = index;
    nameInput.value  = leader.name || "";
    roleInput.value  = leader.role || "";
    linkInput.value  = leader.link || "";
    sheetInput.value = leader.sheetUrl || "";
    tagsInput.value  = (leader.tags || []).join(", ");
    introInput.value = leader.introShort || "";
    tempMediaDataUrl = leader.mediaUrl || "";

    if (tempMediaDataUrl) {
      showPreview(tempMediaDataUrl);
    } else {
      clearPreview();
    }
    mediaInput.value = "";
  };

  window.deleteLeader = function (index) {
    if (!confirm("ì´ ë¦¬ë”ë¥¼ ì‚­ì œí• ê¹Œìš”?")) return;
    leaders.splice(index, 1);
    updateBannerFromForm();
    saveDraft();
    renderLeaderList();
    clearForm();
  };

  window.openSheet = function (index) {
    const leader = leaders[index];
    if (!leader.sheetUrl) {
      alert("ì´ ë¦¬ë”ì˜ ì‘ë‹µ ì‹œíŠ¸ ë§í¬ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.");
      return;
    }
    window.open(leader.sheetUrl, "_blank");
  };

  // JSON ìƒì„± / ë³µì‚¬
  generateJsonBtn.addEventListener("click", () => {
    updateBannerFromForm();
    const jsonObj = {
      banner: data.banner,
      leaders: leaders
    };
    const json = JSON.stringify(jsonObj, null, 2);
    jsonOutput.value = json;
    jsonOutput.scrollTop = 0;
    alert("leaders.json ë‚´ìš©ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ì—­ì„ ë³µì‚¬í•´ì„œ GitHubì— ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.");
  });

  copyJsonBtn.addEventListener("click", async () => {
    if (!jsonOutput.value.trim()) {
      alert("ë¨¼ì € 'JSON ìƒì„±í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ leaders.json ë‚´ìš©ì„ ìƒì„±í•´ì£¼ì„¸ìš”.");
      return;
    }
    try {
      await navigator.clipboard.writeText(jsonOutput.value);
      alert("JSONì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. GitHubì˜ leaders.jsonì— ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.");
    } catch {
      jsonOutput.select();
      document.execCommand("copy");
      alert("JSONì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. (í´ë¦½ë³´ë“œ API ë¯¸ì§€ì› ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì„ íƒëœ ë‚´ìš©ì„ ì§ì ‘ í™•ì¸í•´ ì£¼ì„¸ìš”.)");
    }
  });

  // GitHub leaders.json í˜ì´ì§€ ì—´ê¸°
  openJsonBtn.addEventListener("click", () => {
    window.open(
      "https://github.com/wordycow/so.t-leader-choice/blob/main/leaders.json",
      "_blank"
    );
  });

  // ì´ˆê¸°í™”
  fillBannerForm();
  renderLeaderList();
</script>

</body>
</html>
